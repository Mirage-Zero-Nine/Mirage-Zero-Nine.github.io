<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.57.2 with theme Tranquilpeak 0.4.7-BETA">
<meta name="author" content="Steve Zhou">
<meta name="keywords" content="">
<meta name="description" content="">


<meta property="og:description" content="">
<meta property="og:type" content="article">
<meta property="og:title" content="Search in Sorted 2D Matrix">
<meta name="twitter:title" content="Search in Sorted 2D Matrix">
<meta property="og:url" content="https://yyzhou95.github.io/2019/06/search-in-sorted-2d-matrix/">
<meta property="twitter:url" content="https://yyzhou95.github.io/2019/06/search-in-sorted-2d-matrix/">
<meta property="og:site_name" content="Bingo!">
<meta property="og:description" content="">
<meta name="twitter:description" content="">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2019-06-24T00:00:00">
  
  
    <meta property="article:modified_time" content="2019-06-24T00:00:00">
  
  
  
    
      <meta property="article:section" content="LeetCode Solution">
    
      <meta property="article:section" content="Seaching in Matrix">
    
  
  
    
      <meta property="article:tag" content="Binary Search">
    
      <meta property="article:tag" content="Find Kth Element">
    
  


<meta name="twitter:card" content="summary">











  <meta property="og:image" content="https://yyzhou95.github.io/img/avatar.jpg">
  <meta property="twitter:image" content="https://yyzhou95.github.io/img/avatar.jpg">


    <title>Search in Sorted 2D Matrix</title>

    <link rel="icon" href="https://yyzhou95.github.io/favicon.png">
    

    

    <link rel="canonical" href="https://yyzhou95.github.io/2019/06/search-in-sorted-2d-matrix/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://yyzhou95.github.io/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://yyzhou95.github.io/">Bingo!</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://yyzhou95.github.io/#about">
    
    
    
      
        <img class="header-picture" src="https://yyzhou95.github.io/img/avatar.jpg" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://yyzhou95.github.io/#about">
          <img class="sidebar-profile-picture" src="https://yyzhou95.github.io/img/avatar.jpg" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Steve Zhou</h4>
        
          <h5 class="sidebar-profile-bio">Bingo!</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://yyzhou95.github.io/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://yyzhou95.github.io/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://yyzhou95.github.io/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://yyzhou95.github.io/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://yyzhou95.github.io/#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/yyzhou95" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://yyzhou95.github.io/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="5"
        class="
               hasCoverMetaOut
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-center">
  
    <h1 class="post-title" itemprop="headline">
      Search in Sorted 2D Matrix
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2019-06-24T00:00:00Z">
        
  June 24, 2019

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://yyzhou95.github.io/categories/leetcode-solution">LeetCode Solution</a>, 
    
      <a class="category-link" href="https://yyzhou95.github.io/categories/seaching-in-matrix">Seaching in Matrix</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <p>Links:
- <a href="https://leetcode.com/problems/search-a-2d-matrix">Search a 2D Matrix</a>
- <a href="https://leetcode.com/problems/search-a-2d-matrix-ii">Search a 2D Matrix II</a>
- <a href="https://leetcode.com/problems/kth-smallest-element-in-a-sorted-matrix">Kth Smallest Element in a Sorted Matrix</a>
- <a href="https://leetcode.com/problems/find-k-pairs-with-smallest-sums">Find K Pairs with Smallest Sums</a></p>

<h2 id="problem-description">Problem description</h2>

<h3 id="search-a-2d-matrix">Search a 2D Matrix</h3>

<p>Write an efficient algorithm that searches for a value in an <em>m</em> x <em>n</em> matrix. This matrix has the following properties:</p>

<ul>
<li>Integers in each row are sorted from left to right.</li>
<li>The first integer of each row is greater than the last integer of the previous row.</li>
</ul>

<p><strong>Example 1:</strong></p>

<pre><code>Input:
matrix = [
  [1,   3,  5,  7],
  [10, 11, 16, 20],
  [23, 30, 34, 50]
]
target = 3
Output: true
</code></pre>

<p><strong>Example 2:</strong></p>

<pre><code>Input:
matrix = [
  [1,   3,  5,  7],
  [10, 11, 16, 20],
  [23, 30, 34, 50]
]
target = 13
Output: false
</code></pre>

<h3 id="search-a-2d-matrix-ii">Search a 2D Matrix II</h3>

<p>Write an efficient algorithm that searches for a value in an <em>m</em> x <em>n</em> matrix. This matrix has the following properties:</p>

<ul>
<li>Integers in each row are sorted in ascending from left to right.</li>
<li>Integers in each column are sorted in ascending from top to bottom.</li>
</ul>

<p><strong>Example:</strong></p>

<p>Consider the following matrix:</p>

<pre><code>[
  [1,   4,  7, 11, 15],
  [2,   5,  8, 12, 19],
  [3,   6,  9, 16, 22],
  [10, 13, 14, 17, 24],
  [18, 21, 23, 26, 30]
]
</code></pre>

<p>Given target = <code>5</code>, return <code>true</code>.</p>

<p>Given target = <code>20</code>, return <code>false</code>.</p>

<h3 id="kth-smallest-element-in-a-sorted-matrix">Kth Smallest Element in a Sorted Matrix</h3>

<p>Given a <em>n</em> x <em>n</em> matrix where each of the rows and columns are sorted in ascending order, find the kth smallest element in the matrix.</p>

<p>Note that it is the kth smallest element in the sorted order, not the kth distinct element.</p>

<p><strong>Example:</strong></p>

<pre><code>matrix = [
   [ 1,  5,  9],
   [10, 11, 13],
   [12, 13, 15]
],
k = 8,

return 13.
</code></pre>

<p><strong>Note:</strong>
You may assume k is always valid, 1 ≤ k ≤ n2.</p>

<h2 id="method">Method</h2>

<h3 id="search-a-2d-matrix-1">Search a 2D Matrix</h3>

<p>Treat whole matrix as a sorted list, then use binary search to find target.</p>

<h3 id="search-a-2d-matrix-ii-1">Search a 2D Matrix II</h3>

<p>Binary search each row and column to narrow the search range.</p>

<h3 id="kth-smallest-element-in-a-sorted-matrix-1">Kth Smallest Element in a Sorted Matrix</h3>

<ol>
<li>Start the <strong>Binary Search</strong> with <code>start = matrix[0][0]</code> and <code>end = matrix[n-1][n-1]</code>.</li>
<li>Find <code>median</code> of the <code>start</code> and the <code>end</code>. This <code>median</code> number is NOT necessarily an element in the matrix.</li>
<li>Count all the numbers smaller than or equal to <code>median</code> in the matrix. As the matrix is sorted, we can do this in O(N).</li>
<li>While counting, we can keep track of the “smallest number greater than the <code>median</code>” (<code>n1</code>) and at the same time the “biggest number less than or equal to the <code>median</code>” (<code>n2</code>). These two numbers will be used to adjust the &ldquo;number range&rdquo; for the <strong>Binary Search</strong> in the next iteration.</li>
<li>If the count is equal to K, <code>n1</code> will be our required number as it is the “biggest number less than or equal to the <code>middle</code>”, and is definitely present in the matrix.</li>
<li>If the count is less than K, update <code>start = n2</code> to search in the higher part of the matrix and if the count is greater than K, update <code>end = n1</code> to search in the lower part of the matrix in the next iteration.</li>
</ol>

<h3 id="find-k-pairs-with-smallest-sums">Find K Pairs with Smallest Sums</h3>

<p>It can be regarded to a 2D matrix that contains the value is the sum of two elements in array. Therefore, this problem can be converted to find k smallest (<strong>NOT KTH SMALLEST</strong>)elements in 2D matrix.</p>

<p>Use a priority queue to create order of the sum. Initially, save the sum of first element of an array (for instance, <code>nums1</code>) and each element in second array (<code>nums2</code>). The poll the top of queue. After the poll, add the sum of <code>nums1[i+1] + nums2[j]</code> to heap.</p>

<h2 id="code">Code</h2>

<h3 id="search-a-2d-matrix-2">Search a 2D Matrix</h3>

<pre><code class="language-java">/**
 * Treat whole matrix as a sorted list, then use binary search to find target.
 * Be care of corner case such as empty matrix {}, {{}}.
 *
 * @param matrix input matrix
 * @param target target int
 * @return if target is in matrix
 */
public boolean searchMatrix(int[][] matrix, int target) {

    /* Corner case */
    if (matrix.length == 0) {
        return false;
    }

    int left = 0;
    int right = matrix.length * matrix[0].length - 1;

    while (left &lt;= right) {

        int mid = left + (right - left) / 2;
        int row = mid / matrix[0].length;
        int col = mid % matrix[0].length;

        if (matrix[row][col] == target) {
            return true;
        }
        if (matrix[row][col] &lt; target) {
            left = mid + 1;
        } else {
            right = mid - 1;
        }
    }
    return false;
}
</code></pre>

<h3 id="search-a-2d-matrix-ii-2">Search a 2D Matrix II</h3>

<pre><code class="language-java">/**
 * Binary search row and column to narrow the search range.
 *
 * @param matrix given 2D matrix
 * @param target target number
 * @return if target value in matrix
 */
public boolean searchMatrix(int[][] matrix, int target) {
    if (matrix.length == 0) {
        return false;
    }
    return search(matrix, target, 0, matrix.length - 1, 0, matrix[0].length - 1);
}

/**
 * Binary search.
 *
 * @param m  given matrix
 * @param t  target value
 * @param r1 left index of row
 * @param r2 right index of row
 * @param c1 left index of column
 * @param c2 right index of column
 * @return if target exist in given range
 */
private boolean search(int[][] m, int t, int r1, int r2, int c1, int c2) {

    if (r2 &lt; r1 || c2 &lt; c1 || r1 &gt;= m.length || c1 &gt; m[0].length || r2 &lt; 0 || c2 &lt; 0) {
        return false;
    }

    int rowMid = r1 + (r2 - r1) / 2;
    int colMid = c1 + (c2 - c1) / 2;

    if (m[rowMid][colMid] == t) {
        return true;
    } else if (t &gt; m[rowMid][colMid]) {
        return (search(m, t, r1, r2, colMid + 1, c2)) || (search(m, t, rowMid + 1, r2, c1, colMid));
    } else if (t &lt; m[rowMid][colMid]) {
        return (search(m, t, r1, rowMid - 1, colMid, c2) || (search(m, t, r1, r2, c1, colMid - 1)));
    }
    return false;
}
</code></pre>

<h3 id="kth-smallest-element-in-a-sorted-matrix-2">Kth Smallest Element in a Sorted Matrix</h3>

<pre><code class="language-java">/**
 * Binary search.
 * Start the Binary Search with start = matrix[0][0] and end = matrix[n-1][n-1].
 * Find median of the start and the end. This median is NOT necessarily an element in the matrix.
 * Count all the numbers smaller than or equal to median in the matrix. It can be done in O(N).
 * While counting, keep tracking two values:
 * “smallest number greater than the middle” (n1) and “biggest number less than or equal to the middle” (n2).
 * These two numbers will be used to adjust the &quot;number range&quot; for the Binary Search in the next iteration.
 * If count == K, n1 will be required as it is the “biggest number less than or equal to the middle”.
 * If count &lt; K, update start = n2 to search in the higher part of the matrix.
 * If the count is greater than ‘K’, update end = n1 to search in the lower part of the matrix in the next iteration.
 *
 * @param matrix given matrix
 * @param k      kth smallest element
 * @return kth smallest element in the sorted order
 */
public int kthSmallest(int[][] matrix, int k) {
    int start = matrix[0][0], end = matrix[matrix.length - 1][matrix.length - 1];

    while (start &lt; end) {
        int mid = start + (end - start) / 2;
        int[] pair = {matrix[0][0], matrix[matrix.length - 1][matrix.length - 1]};
        int count = countLessEqual(matrix, mid, pair);      // pair will update to closest smaller to median and floor value of median

        /*
         * Narrow the search range if # of smaller elements are not k.
         * If # of smaller elements &lt; k, then search range is narrowed to closest smaller element to median - end
         * If # of smaller elements &gt; k, then search range is narrowed to start - floor value of median */
        if (count == k) {
            return pair[0];
        } else if (count &lt; k) {
            start = pair[1];        // closest smaller element to median 
        } else {
            end = pair[0];
        }
    }
    return start;
}

/**
 * Find closest smaller to median and floor value of median.
 *
 * @param matrix given matrix
 * @param mid    median of given range
 * @param pair   previous pair of closest smaller to median and floor value of median
 * @return count of # that is smaller than median
 */
private int countLessEqual(int[][] matrix, int mid, int[] pair) {
    int count = 0;
    int n = matrix.length, row = n - 1, column = 0;

    while (row &gt;= 0 &amp;&amp; column &lt; n) {
        if (matrix[row][column] &gt; mid) {
            pair[1] = Math.min(pair[1], matrix[row--][column]);
        } else {
            pair[0] = Math.max(pair[0], matrix[row][column++]);
            count += row + 1;       // end of row is the largest element in row
        }
    }
    return count;
}
</code></pre>

<h3 id="find-k-pairs-with-smallest-sums-1">Find K Pairs with Smallest Sums</h3>

<pre><code class="language-java">/**
 * It can be regarded to a 2D matrix that contains the value is the sum of two elements in array.
 * Therefore, this problem can be converted to find k smallest elements in 2D matrix.
 *
 * @param nums1 first array
 * @param nums2 second array
 * @param k     k pairs with the smallest sums
 * @return k pairs (u1,v1),(u2,v2) ...(uk,vk) with the smallest sums
 */
public List&lt;List&lt;Integer&gt;&gt; kSmallestPairs(int[] nums1, int[] nums2, int k) {
    List&lt;List&lt;Integer&gt;&gt; out = new ArrayList&lt;&gt;();

    /* Corner case */
    if (nums1 == null || nums1.length == 0 || nums2 == null || nums2.length == 0) {
        return out;
    }

    PriorityQueue&lt;Tuple&gt; q = new PriorityQueue&lt;&gt;();

    /*
     * Add sum of first element in nums1 (smallest in nums1) and each element in nums2.
     * Assume these values are smallest in array. */
    for (int j = 0; j &lt; nums2.length; j++) {
        q.offer(new Tuple(0, j, nums1[0] + nums2[j]));
    }

    while (k-- &gt; 0 &amp;&amp; !q.isEmpty()) {

        /*
         * First polled element is nums1[0] + nums2[0]. This is smallest sum in two arrays.
         * Add nums1[1] + nums[0] to queue, based on heap comparator, it will be inserted to correct position.
         * Then poll the second smallest element in queue, and keep it until find k smallest pairs. */
        Tuple cur = q.poll();
        List&lt;Integer&gt; curList = new ArrayList&lt;&gt;();
        curList.add(nums1[cur.x]);
        curList.add(nums2[cur.y]);
        out.add(new ArrayList&lt;&gt;(curList));
        if (cur.x != nums1.length - 1) {
            q.offer(new Tuple(cur.x + 1, cur.y, nums1[cur.x + 1] + nums2[cur.y]));      // y is decided by polled element
        }
    }
    return out;
}

/**
 * Based on given index, save the sum of it.
 */
class Tuple implements Comparable&lt;Tuple&gt; {
    int x, y, val;

    /**
     * @param x   index in array1
     * @param y   index in array2
     * @param val sum of two elements in array
     */
    Tuple(int x, int y, int val) {
        this.x = x;
        this.y = y;
        this.val = val;
    }

    /**
     * @param b the other Tuple object
     * @return priority of two Tuples
     */
    @Override
    public int compareTo(Tuple b) {
        return this.val - b.val;        // Tuple with smaller sum is in prior of queue
    }
}
</code></pre>

<h2 id="others">Others</h2>

<h2 id="solution-1-using-heap-o-min-k-n-k-logn">Solution 1 using Heap: O(min(K,N)+K∗logN)</h2>

<p>This problem can be easily converted to &lsquo;Kth Smallest Number in M Sorted Lists&rsquo;. As each row (or column) of the given matrix can be seen as a sorted list, we essentially need to find the Kth smallest number in ‘N’ sorted lists. This solution is taken from <a href="https://www.educative.io/collection/page/5668639101419520/5671464854355968/4605334997958656">Kth Smallest Number in a Sorted Matrix</a>.</p>

<p><strong>Java:</strong></p>

<pre><code class="language-java">import java.util.*;

class Node {
  int row;
  int col;

  Node(int row, int col) {
    this.row = row;
    this.col = col;
  }
}

class Solution {

  public static int findKthSmallest(int[][] matrix, int k) {
    PriorityQueue&lt;Node&gt; minHeap = new PriorityQueue&lt;Node&gt;((n1, n2) -&gt; matrix[n1.row][n1.col] - matrix[n2.row][n2.col]);

    // put the 1st element of each row in the min heap we don't need to push more than 'k' elements in the heap
    for (int i = 0; i &lt; matrix.length &amp;&amp; i &lt; k; i++)
      minHeap.add(new Node(i, 0));

    // take the smallest (top) element form the min heap, if the running count is equal to k return the number
    // if the row of the top element has more elements, add the next element to the heap
    int numberCount = 0, result = 0;
    while (!minHeap.isEmpty()) {
      Node node = minHeap.poll();
      result = matrix[node.row][node.col];
      if (++numberCount == k)
        break;
      node.col++;
      if (matrix[0].length &gt; node.col)
        minHeap.add(node);
    }
    return result;
  }
}
</code></pre>

<p><strong>Python:</strong></p>

<pre><code class="language-python">from heapq import *

def find_Kth_smallest(matrix, k):
    minHeap = []

    # put the 1st element of each row in the min heap we don't need to push more than 'k' elements in the heap
    for i in range(min(k, len(matrix))):
        heappush(minHeap, (matrix[i][0], 0, matrix[i]))

    # take the smallest(top) element form the min heap, if the running count is equal to k' return the number
    # if the row of the top element has more elements, add the next element to the heap
    numberCount, number = 0, 0
    while minHeap:
        number, i, row = heappop(minHeap)
        numberCount += 1
        if numberCount == k:
            break
        if len(row) &gt; i+1:
            heappush(minHeap, (row[i+1], i+1, row))
    return number
</code></pre>

<p><strong>C++:</strong></p>

<pre><code class="language-c++">using namespace std;

#include &lt;iostream&gt;
#include &lt;queue&gt;
#include &lt;vector&gt;

class KthSmallestInSortedMatrix {
 public:
  struct numCompare {
    bool operator()(const pair&lt;int, pair&lt;int, int&gt;&gt; &amp;x, const pair&lt;int, pair&lt;int, int&gt;&gt; &amp;y) {
      return x.first &gt; y.first;
    }
  };

  static int findKthSmallest(vector&lt;vector&lt;int&gt;&gt; &amp;matrix, int k) {
    int n = matrix.size();
    priority_queue&lt;pair&lt;int, pair&lt;int, int&gt;&gt;, vector&lt;pair&lt;int, pair&lt;int, int&gt;&gt;&gt;, numCompare&gt; minHeap;

    // put the 1st element of each row in the min heap
    // we don't need to push more than 'k' elements in the heap
    for (int i = 0; i &lt; n &amp;&amp; i &lt; k; i++) {
      minHeap.push(make_pair(matrix[i][0], make_pair(i, 0)));
    }

    // take the smallest element form the min heap, if the running count is equal to k return the number
    // if the row of the top element has more elements, add the next element to the heap
    int numberCount = 0, result = 0;
    while (!minHeap.empty()) {
      auto heapTop = minHeap.top();
      minHeap.pop();
      result = heapTop.first;
      if (++numberCount == k) {
        break;
      }

      heapTop.second.second++;
      if (n &gt; heapTop.second.second) {
        heapTop.first = matrix[heapTop.second.first][heapTop.second.second];
        minHeap.push(heapTop);
      }
    }
    return result;
  }
};
</code></pre>

<p>The space complexity of the above solutions will be O(N) and the time complexity will be O(min(K,N)+K∗logN).</p>

<h2 id="solution-2-using-binary-search-o-n-log-max-min">Solution 2 using Binary Search: O(N∗log(max−min))</h2>

<p>Since each row and column of the matrix is sorted, is it possible to use <strong>Binary Search</strong> to find the Kth smallest number?</p>

<p>The biggest problem to use <strong>Binary Search</strong> in this case is that we don’t have a straightforward sorted array, instead we have a matrix. As we remember, in <strong>Binary Search</strong>, we calculate the middle index of the search space (‘1’ to ‘N’) and see if our required number is pointed out by the middle index; if not we either search in the lower half or the upper half. In a sorted matrix, we can’t really find a middle. Even if we do consider some index as middle, it is not straightforward to find the search space containing numbers bigger or smaller than the number pointed out by the middle index.</p>

<p>An alternate could be to apply the <strong>Binary Search</strong> on the “number range” instead of the “index range”. As we know that the smallest number of our matrix is at the top left corner and the biggest number is at the bottom lower corner. These two number can represent the “range” i.e., the <code>start</code> and the <code>end</code> for the <strong>Binary Search</strong>. Here is how our algorithm will work:</p>

<ol>
<li>Start the <strong>Binary Search</strong> with <code>start = matrix[0][0]</code> and <code>end = matrix[n-1][n-1]</code>.</li>
<li>Find <code>middle</code> of the <code>start</code> and the <code>end</code>. This <code>middle</code> number is NOT necessarily an element in the matrix.</li>
<li>Count all the numbers smaller than or equal to <code>middle</code> in the matrix. As the matrix is sorted, we can do this in O(N).</li>
<li>While counting, we can keep track of the “smallest number greater than the <code>middle</code>” (let’s call it <code>n1</code>) and at the same time the “biggest number less than or equal to the <code>middle</code>” (let’s call it <code>n2</code>). These two numbers will be used to adjust the &ldquo;number range&rdquo; for the <strong>Binary Search</strong> in the next iteration.</li>
<li>If the count is equal to ‘K’, <code>n1</code> will be our required number as it is the “biggest number less than or equal to the <code>middle</code>”, and is definitely present in the matrix.</li>
<li>If the count is less than ‘K’, we can update <code>start = n2</code> to search in the higher part of the matrix and if the count is greater than ‘K’, we can update <code>end = n1</code> to search in the lower part of the matrix in the next iteration.</li>
</ol>

<p>Here is the visual representation of this algorithm:</p>

<p><img src="../../static/img/image_1559108433.png" alt="image" /></p>

<p><strong>Java:</strong></p>

<pre><code class="language-java">class Solution {
  public static int findKthSmallest(int[][] matrix, int k) {
    int n = matrix.length;
    int start = matrix[0][0], end = matrix[n - 1][n - 1];
    while (start &lt; end) {
      int mid = start + (end - start) / 2;
      // first number is the smallest and the second number is the largest
      int[] smallLargePair = { matrix[0][0], matrix[n - 1][n - 1] };

      int count = countLessEqual(matrix, mid, smallLargePair);

      if (count == k)
        return smallLargePair[0];

      if (count &lt; k)
        start = smallLargePair[1]; // search higher
      else
        end = smallLargePair[0]; // search lower
    }

    return start;
  }

  private static int countLessEqual(int[][] matrix, int mid, int[] smallLargePair) {
    int count = 0;
    int n = matrix.length, row = n - 1, col = 0;
    while (row &gt;= 0 &amp;&amp; col &lt; n) {
      if (matrix[row][col] &gt; mid) {
        // as matrix[row][col] is bigger than the mid, let's keep track of the
        // smallest number greater than the mid
        smallLargePair[1] = Math.min(smallLargePair[1], matrix[row][col]);
        row--;
      } else {
        // as matrix[row][col] is greater than or equal to the mid, let's keep track of the
        // biggest number less than or equal to the mid
        smallLargePair[0] = Math.max(smallLargePair[0], matrix[row][col]);
        count += row + 1;
        col++;
      }
    }
    return count;
  }
}
</code></pre>

<p><strong>Python:</strong></p>

<pre><code class="language-python">def find_Kth_smallest(matrix, k):
  n = len(matrix)
  start, end = matrix[0][0], matrix[n - 1][n - 1]
  while start &lt; end:
    mid = start + (end - start) / 2
    smaller, larger = (matrix[0][0], matrix[n - 1][n - 1])

    count, smaller, larger = count_less_equal(matrix, mid, smaller, larger)

    if count == k:
      return smaller
    if count &lt; k:
      start = larger  # search higher
    else:
      end = smaller  # search lower

  return start


def count_less_equal(matrix, mid, smaller, larger):
  count, n = 0, len(matrix)
  row, col = n - 1, 0
  while row &gt;= 0 and col &lt; n:
    if matrix[row][col] &gt; mid:
      # as matrix[row][col] is bigger than the mid, let's keep track of the
      # smallest number greater than the mid
      larger = min(larger, matrix[row][col])
      row -= 1
    else:
      # as matrix[row][col] is greater than or equal to the mid, let's keep track of the
      # biggest number less than or equal to the mid
      smaller = max(smaller, matrix[row][col])
      count += row + 1
      col += 1

  return count, smaller, larger
</code></pre>

<p><strong>C++:</strong></p>

<pre><code class="language-c++">class KthSmallestInSortedMatrix {
 public:
  static int findKthSmallest(vector&lt;vector&lt;int&gt;&gt; &amp;matrix, int k) {
    int n = matrix.size();
    int start = matrix[0][0], end = matrix[n - 1][n - 1];
    while (start &lt; end) {
      int mid = start + (end - start) / 2;
      // first number is the smallest and the second number is the largest
      pair&lt;int, int&gt; smallLargePair = {matrix[0][0], matrix[n - 1][n - 1]};
      int count = countLessEqual(matrix, mid, smallLargePair);
      if (count == k) {
        return smallLargePair.first;
      }

      if (count &lt; k) {
        start = smallLargePair.second;  // search higher
      } else {
        end = smallLargePair.first;  // search lower
      }
    }

    return start;
  }

 private:
  static int countLessEqual(vector&lt;vector&lt;int&gt;&gt; &amp;matrix, int mid, pair&lt;int, int&gt; &amp;smallLargePair) {
    int count = 0;
    int n = matrix.size(), row = n - 1, col = 0;
    while (row &gt;= 0 &amp;&amp; col &lt; n) {
      if (matrix[row][col] &gt; mid) {
        // as matrix[row][col] is bigger than the mid, let's keep track of the
        // smallest number greater than the mid
        smallLargePair.second = min(smallLargePair.second, matrix[row][col]);
        row--;
      } else {
        // as matrix[row][col] is greater than or equal to the mid, let's keep track of the
        // biggest number less than or equal to the mid
        smallLargePair.first = max(smallLargePair.first, matrix[row][col]);
        count += row + 1;
        col++;
      }
    }
    return count;
  }
};
</code></pre>

<p>The algorithm runs in constant space O(1).</p>

<p>The above solution was taken from <a href="https://www.educative.io/collection/page/5668639101419520/5671464854355968/4605334997958656">Grokking the Coding Interview</a>.</p>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://yyzhou95.github.io/tags/binary-search/">Binary Search</a>

  <a class="tag tag--primary tag--small" href="https://yyzhou95.github.io/tags/find-kth-element/">Find Kth Element</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://yyzhou95.github.io/2019/06/median-of-two-sorted-arrays/" data-tooltip="Median of Two Sorted Arrays">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://yyzhou95.github.io/2019/06/heaters/" data-tooltip="Heaters">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2019 Steve Zhou. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://yyzhou95.github.io/2019/06/median-of-two-sorted-arrays/" data-tooltip="Median of Two Sorted Arrays">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://yyzhou95.github.io/2019/06/heaters/" data-tooltip="Heaters">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="5">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://yyzhou95.github.io/img/avatar.jpg" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Steve Zhou</h4>
    
      <div id="about-card-bio">Bingo!</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Software Engineer, Full-Stack Developer.
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Los Angeles
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://yyzhou95.github.io/img/bg.jpeg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://yyzhou95.github.io/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
  




    
  </body>
</html>

