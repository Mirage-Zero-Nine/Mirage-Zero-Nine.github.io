<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Repeated DNA Sequences | Posts</title>
    <link rel="stylesheet" type="text/css"
          href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Martel+Sans:200,300,400,600,700,800,900&display=swap"
          rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Raleway:200i,400,800" rel="stylesheet">
    <link rel="stylesheet" href="../../static/css/post-content.css">
    <link rel="stylesheet" href="../../static/bootstrap-4.3.1-dist/css/bootstrap.css">
    <link rel="stylesheet" href="../../static/css/post-content.css">

    <!--    title icon        -->
    <link rel="shortcut icon" type="image/x-icon" href="../../static/img/Avatar-3.jpg"/>
</head>
<body>

<!--        nav bar     -->
<nav class="navbar navbar-expand-lg py-0 fixed-top">
    <div class="container">
        <a class="navbar-brand" href="https://yyzhou95.github.io/">HOME</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="../index.html">Posts <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="../../tags/index.html">Tags <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="../../algorithm/index.html">Algorithm <span
                            class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="../../archived/index.html">Archived <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item dropdown active">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                       data-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false">
                        Other Links
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" href="https://github.com/yyzhou95">Github</a>
                        <a class="dropdown-item" href="https://github.com/yyzhou95/yyzhou95.github.io">This page</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="../../about/">About Me</a>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</nav>

<section class="post-content">
    <div class="container">

        <div class="post-heading">
            <h1>
                Repeated DNA Sequences
            </h1>
        </div>

        <div class="text-right post-date">
            July 01, 2019
        </div>
        <div class="post-main">
            <p><span>Link: </span><a href='https://leetcode.com/problems/repeated-dna-sequences'><span>Repeated DNA Sequences</span></a>
            </p>
            <h2><span>Problem description </span></h2>
            <p><span>All DNA is composed of a series of nucleotides abbreviated as A, C, G, and T, for example: &quot;ACGAATTCCG&quot;. When studying DNA, it is sometimes useful to identify repeated sequences within the DNA.</span>
            </p>
            <p><span>Write a function to find all the 10-letter-long sequences (substrings) that occur more than once in a DNA molecule.</span>
            </p>
            <p><strong><span>Example:</span></strong></p>
            <pre><code>Input: s = &quot;AAAAACCCCCAAAAACCCCCCAAAAAGGGTTT&quot;

Output: [&quot;AAAAACCCCC&quot;, &quot;CCCCCAAAAA&quot;]
</code></pre>
            <h2><span>Method</span></h2>
            <p><span>Encoding each &#39;A&#39;, &#39;C&#39;, &#39;G&#39;, &#39;T&#39; into binary digit, such as 00, 01, 10, 11. In this way, each 10-letter-long sequences will be 20 bits long, which is under size of an int. Map each subsequence into bits and check if each sequence has been shown before.</span>
            </p>
            <h2><span>Code</span></h2>
            <pre><code class='language-java' lang='java'>/**
 * Encoding each &#39;A&#39;, &#39;C&#39;, &#39;G&#39;, &#39;T&#39; into binary digit, such as 00, 01, 10, 11.
 * In this way, each 10-letter-long sequences will be 20 bits long, which is under size of an int.
 * Map each subsequence into bits and check if each sequence has been shown before.
 *
 * @param s given DNA molecule
 * @return all the 10-letter-long sequences in s
 */
public List&lt;String&gt; findRepeatedDnaSequences(String s) {

    List&lt;String&gt; out = new ArrayList&lt;&gt;();
    HashSet&lt;Integer&gt; sequence = new HashSet&lt;&gt;();                // save previous sequence
    HashSet&lt;Integer&gt; duplicatedSequence = new HashSet&lt;&gt;();      // save previous result added into list
    char[] map = new char[26];

    map[&#39;C&#39; - &#39;A&#39;] = 1;     // mapping &#39;C&#39; to 01, &#39;A&#39; is 00
    map[&#39;G&#39; - &#39;A&#39;] = 2;     // mapping &#39;G&#39; to 10
    map[&#39;T&#39; - &#39;A&#39;] = 3;     // mapping &#39;T&#39; to 11

    for (int i = 0; i &lt; s.length() - 9; i++) {
        int v = 0;

        for (int j = i; j &lt; i + 10; j++) {      // search 10 chars ahead
            v &lt;&lt;= 2;                            // left shift 2 digit for new incoming char
            v |= map[s.charAt(j) - &#39;A&#39;];        // add coding to the end to extend
        }

        /*
         * 1. This sequence is not a new sequence (duplicated)
         * 2. This duplicated sequence has not been added to result (avoid duplicated result in output list) */
        if (!sequence.add(v) &amp;&amp; duplicatedSequence.add(v)) {
            out.add(s.substring(i, i + 10));
        }
    }
    return out;
</code></pre>
        </div>
    </div>
</section>
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<!--        This order must be followed!!       -->
<script src="../../static/jquery/jquery-3.3.1.js"></script>
<script src="../../static/popper/popper.js"></script>
<script src="../../static/bootstrap-4.3.1-dist/js/bootstrap.js"></script>

<!--        inner script to control nav bar become purple        -->

</body>
</html>